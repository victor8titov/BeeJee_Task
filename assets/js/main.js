!function(e){var t={};function i(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(n,a,function(t){return e[t]}.bind(null,a));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=2)}([function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST",n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Promise((function(a,s){var r=new XMLHttpRequest;r.open(i,e,!0),r.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),r.onreadystatechange=function(){4===r.readyState&&200===r.status?(console.log("server 200"),a(r.responseText)):4===r.readyState&&s("Запрос завершён с кодом ответа: "+r.status)},console.log("--:","send: ",t);var c="";if(n)c+="data="+JSON.stringify(t);else{for(var o in t)c+=o+"="+t[o]+"&";c=c.slice(0,-1)}r.send(c)}))}},,function(e,t,i){"use strict";var n=r(i(0)),a=r(i(3)),s=r(i(4));function r(e){return e&&e.__esModule?e:{default:e}}!function(){var e=document.getElementById("main__filter");function t(e){e=e||{type:"undefined",direction:"on_increase",status:!1,admin_create:!1},console.log("запрашиваем main/tasks"),(0,n.default)("/main/tasks/",e).then((function(e){i(e)}),(function(e){console.log(e)}))}function i(e){var t=document.querySelector(".main__tasks");t&&(s.default.remove(),a.default.remove(),t.parentNode.removeChild(t)),document.querySelector(".main__filter").insertAdjacentHTML("afterend",e),s.default.add(),a.default.add()}e.addEventListener("submit",(function(i){i.preventDefault(),t({type:e.type.value,direction:e.direction.value,status:e.status.checked,admin_create:e.admin_create.checked})})),a.default.EventCancelSaveToServer=t,a.default.insertTasks=i,t()}()},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=i(0),s=(n=a)&&n.__esModule?n:{default:n};var r={buffer:void 0,currentTask:void 0,add:function(){var e=this;flagAdmin&&(this.card.target||this.init(),this.cleaningBuffer(),document.querySelectorAll(".task").forEach((function(t){return t.addEventListener("click",e.EventClickTask)})))},remove:function(){var e=this;document.querySelectorAll(".task").forEach((function(t){return t.removeEventListener("click",e.EventClickTask)})),this.hiddenAdminMenu()},init:function(){this.card.init(),this.addEvents()},showAdminMenu:function(){var e=document.querySelector(".admin-menu").classList;e.remove("d-none"),e.add("d-flex")},hiddenAdminMenu:function(){var e=document.querySelector(".admin-menu").classList;e.remove("d-flex"),e.add("d-none")},addEvents:function(){var e=this;this.EventClickTask=this.EventClickTask.bind(this),this.EventCancel=this.EventCancel.bind(this),this.EventSave=this.EventSave.bind(this),this.EventChange=this.EventChange.bind(this),this.EventDeleteTask=this.EventDeleteTask.bind(this),this.EventSaveToServer=this.EventSaveToServer.bind(this),this.card.target.querySelector("#create-task__button-cancel").addEventListener("click",this.EventCancel),this.card.target.querySelector("#create-task__button-save").addEventListener("click",this.EventSave),this.card.target.querySelector("#create-task__button-delete").addEventListener("click",this.EventDeleteTask),this.card.target.querySelectorAll("#create-task__name, #create-task__email, #create-task__task, #create-task__status").forEach((function(t){return t.addEventListener("change",e.EventChange)})),document.querySelector("#admin-menu__button-save").addEventListener("click",this.EventSaveToServer),document.querySelector("#admin-menu__button-cancel").addEventListener("click",this.EventCancelSaveToServer)},EventClickTask:function(e){this.currentTask=e.currentTarget;var t={name:this.currentTask.querySelector(".task__name").innerText,email:this.currentTask.querySelector(".task__email").innerText,task:this.currentTask.querySelector(".task__task").innerText,status:/Выполнено/.test(this.currentTask.querySelector(".task__status").innerText),id:this.currentTask.id,admin_create:void 0};this.card.show(t)},EventSaveToServer:function(e){var t=this;(0,s.default)("/main/savetoserver/",this.buffer,"post",!0).then((function(e){t.insertTasks(e)}),(function(e){console.log(e)}))},EventCancelSaveToServer:function(e){},EventSave:function(e){var t=this.card.cardData.id,i=this.card.cardData,n=this.card.inputData;for(var a in i)if("id"!==a&&n[a]!==i[a]){if(this.buffer.hasOwnProperty(t)||(this.buffer[t]={}),this.buffer[t][a]=i[a],"name"===a||"email"===a||"task"===a){var s=".task__"+a;this.currentTask.querySelector(s).innerText=i[a]}if("status"===a){var r=i[a]?"Выполнено":"Не выполнено";this.currentTask.querySelector(".task__status").innerHTML='<span class="font-weight-bold ">Статус: </span>'+r+"</p>"}this.buffer[t].hasOwnProperty("task")&&(this.buffer[t].admin_create=!0)}this.card.hidden()},EventCancel:function(e){this.card.hidden()},EventDeleteTask:function(e){var t=this.card.cardData.id;this.buffer.hasOwnProperty(t)||(this.buffer[t]={}),this.buffer[t].delete=!0,this.currentTask.classList.add("delete"),this.card.hidden()},EventChange:function(e){name=e.target.name,"status"!==name?this.card.cardData[name]=e.target.value:this.card.cardData[name]=e.target.checked},card:{target:void 0,cardData:void 0,inputData:void 0,init:function(){this.target=document.querySelector(".create-task")},show:function(e){this.target.classList.add("d-block"),this.inputData=e,this.cardData=Object.assign({},e),this.addData()},hidden:function(){this.cleaningCard(),this.target.classList.remove("d-block"),r.currentTask=void 0,Object.keys(r.buffer).length&&r.showAdminMenu(),console.log(r.buffer)},addData:function(){var e=this.cardData;this.target.querySelector("#create-task__name").value=e.name,this.target.querySelector("#create-task__email").value=e.email,this.target.querySelector("#create-task__task").value=e.task,this.target.querySelector("#create-task__status").checked=e.status},cleaningCard:function(){this.target.querySelector("#create-task__name").value="",this.target.querySelector("#create-task__email").value="",this.target.querySelector("#create-task__task").value="",this.target.querySelector("#create-task__status").checked=!1,this.cardData=void 0,this.inputData=void 0}},cleaningBuffer:function(){this.buffer={}}};t.default=r},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={target:document.querySelector(".main__pagination"),previous:document.getElementById("pagination__previous"),next:document.getElementById("pagination__next"),domTasks:"",domDigitalA:"",currentList:1,countList:"",add:function(){this.domTasks=document.querySelectorAll(".main__tasks .card"),this.countList=parseInt(this.domTasks.length/3,10),this.domTasks.length%3!=0&&++this.countList,this.countList<=1||(this.generateDigitLine(),this.addEvents(),this.target.classList.remove("d-none"),this.target.classList.add("d-flex"))},remove:function(){this.removeEvents(),this.removeDigitalLine(),this.target.classList.remove("d-flex"),this.target.classList.add("d-none"),this.currentList=1},addEvents:function(){var e=this;this.EventClickPrevious=this.EventClickPrevious.bind(this),this.EventClickNext=this.EventClickNext.bind(this),this.EventClickDigit=this.EventClickDigit.bind(this),this.previous.addEventListener("click",this.EventClickPrevious),this.next.addEventListener("click",this.EventClickNext),this.domDigitalA=document.querySelectorAll("#digit_a").forEach((function(t){return t.addEventListener("click",e.EventClickDigit)}))},removeEvents:function(){var e=this;this.previous.removeEventListener("click",this.EventClickPrevious),this.next.removeEventListener("click",this.EventClickNext),this.domDigitalA=document.querySelectorAll("#digit_a").forEach((function(t){return t.removeEventListener("click",e.EventClickDigit)}))},generateDigitLine:function(){for(var e=1;e<=this.countList;e++){var t=document.createElement("li");t.className=this.currentList==e?"page-item active":"page-item",t.id="digit_li";var i=document.createElement("a");i.href="#",i.className="page-link",i.id="digit_a",i.innerText=e,t.append(i),document.querySelector(".page-item:last-of-type").insertAdjacentElement("beforebegin",t)}},removeDigitalLine:function(){document.querySelectorAll("#digit_li").forEach((function(e){return e.parentNode.removeChild(e)}))},EventClickPrevious:function(e){e.preventDefault(),this.currentList<2||(this.hiddenAllTasks(),this.removeActiveClass(),--this.currentList,this.showCurrentListTasks(),this.instActiveClass())},EventClickNext:function(e){e.preventDefault(),this.currentList>=this.countList||(this.hiddenAllTasks(),this.removeActiveClass(),++this.currentList,this.showCurrentListTasks(),this.instActiveClass())},EventClickDigit:function(e){e.preventDefault(),this.hiddenAllTasks(),this.removeActiveClass(),this.currentList=parseInt(e.target.innerText,10),this.showCurrentListTasks(),this.instActiveClass()},hiddenAllTasks:function(){this.domTasks.forEach((function(e){return e.classList.add("d-none")}))},removeActiveClass:function(){document.querySelectorAll("#digit_li")[this.currentList-1].classList.remove("active")},instActiveClass:function(){document.querySelectorAll("#digit_li")[this.currentList-1].classList.add("active")},showCurrentListTasks:function(){var e=this;this.domTasks.forEach((function(t,i){i+1>=3*e.currentList-2&&i+1<=3*e.currentList&&t.classList.remove("d-none")}))}};t.default=n}]);
//# sourceMappingURL=main.js.map